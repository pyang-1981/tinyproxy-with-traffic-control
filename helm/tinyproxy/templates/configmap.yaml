apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "tinyproxy.fullname" . | trunc 63 | trimSuffix "-" }}-config
  labels:
    app: {{ include "tinyproxy.name" . }}
data:
  tinyproxy.conf: |-
    # Generated by Helm chart
    Port {{ .Values.service.port }}
    Timeout 600
    DefaultErrorFile "/usr/local/share/tinyproxy/default.html"
    StatFile "/usr/local/share/tinyproxy/stats.html"
    LogLevel Info
    # Traffic control device
    TrafficControlDevName {{ .Values.trafficControl.devName }}
    {{ include "tinyproxy.tcRules" . | indent 4 }}
    {{ include "tinyproxy.tcMappings" . | indent 4 }}
